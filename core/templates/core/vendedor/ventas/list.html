{% extends 'core/base_dashboard.html' %}
{% block title %}Mis Ventas{% endblock %}
{% block content %}

<div class="max-w-7xl mx-auto mt-8">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-bold text-green-400">📦 Mis Ventas</h2>
    <a href="{% url 'venta_create' %}" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-semibold shadow-md transition duration-200">
      ➕ Registrar Venta
    </a>
  </div>

  <!-- 🔍 Buscador + Fecha -->
  <form method="get" class="mb-4 flex flex-wrap items-center gap-3">
    <input type="text" name="q" placeholder="Buscar por cliente o factura..."
           value="{{ query|default_if_none:'' }}"
           class="px-3 py-2 rounded bg-gray-900 text-white border border-green-500">

    <input type="date" name="fecha_inicio" value="{{ fecha_inicio }}" class="px-3 py-2 rounded bg-gray-900 text-white border border-green-500">
    <input type="date" name="fecha_fin" value="{{ fecha_fin }}" class="px-3 py-2 rounded bg-gray-900 text-white border border-green-500">

    <button type="submit" class="bg-green-600 hover:bg-green-700 text-black font-bold px-4 py-2 rounded">
      🔍 Buscar
    </button>
  </form>

  <!-- 🧾 Tabla -->
  <div class="overflow-x-auto">
    <table class="w-full text-sm bg-zinc-900 border border-zinc-700 rounded">
      <thead class="bg-zinc-800 text-green-300 text-left">
        <tr>
          <th class="p-3"># Factura</th>
          <th class="p-3">Cliente</th>
          <th class="p-3">Tipo de Pago</th>
          <th class="p-3">Total</th>
          <th class="p-3">Fecha</th>
          <th class="p-3">Estado</th>
          <th class="p-3">Detalles</th>
        </tr>
      </thead>
      <tbody class="text-white">
        {% for venta in ventas %}
        <tr class="border-t border-zinc-700 hover:bg-zinc-800">
          <td class="p-3 font-mono text-blue-400">{{ venta.numero_factura }}</td>
          <td class="p-3">{{ venta.cliente.nombre }}</td>
          <td class="p-3 capitalize">{{ venta.tipo_pago }}</td>
          <td class="p-3 text-green-300 font-semibold">${{ venta.total }}</td>
          <td class="p-3">{{ venta.fecha|date:"Y-m-d H:i" }}</td>
          <td class="p-3">
            {% if venta.estado == 'activa' %}
              <span class="text-green-400 font-semibold">Activa</span>
            {% else %}
              <span class="text-red-400 font-semibold">Anulada</span>
            {% endif %}
          </td>
          <td class="p-3">
            <a href="{% url 'venta_vendedor_detail' venta.id %}" class="text-blue-400 hover:text-blue-300 font-semibold underline">
              Ver
            </a>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="7" class="p-3 text-center text-zinc-400">No has registrado ventas aún.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
